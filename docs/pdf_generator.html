---

title: pdf_generator


keywords: fastai
sidebar: home_sidebar

summary: "Ce module permet de lire les fichiers reçu et de générer le PDF, à l'aide du module pdf_helper."
description: "Ce module permet de lire les fichiers reçu et de générer le PDF, à l'aide du module pdf_helper."
nb_path: "pdf_generator.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: pdf_generator.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%writefile</span> data.csv
<span class="n">NomParent</span><span class="p">,</span><span class="n">PrenomParent</span><span class="p">,</span><span class="n">NomEnfant</span><span class="p">,</span><span class="n">PrenomEnfant</span><span class="p">,</span><span class="n">DateNaissance</span><span class="p">,</span><span class="n">Moyen</span>
<span class="n">NomParent1</span><span class="p">,</span><span class="n">PrenomParent1</span><span class="p">,</span><span class="n">NomEnfant1</span><span class="p">,</span><span class="n">PrenomEnfant1</span><span class="p">,</span><span class="mi">12</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">2010</span><span class="p">,</span><span class="n">pied</span>
<span class="n">NomParent2</span><span class="p">,</span><span class="n">PrenomParent2</span><span class="p">,</span><span class="n">NomEnfant2</span><span class="p">,</span><span class="n">PrenomEnfant2</span><span class="p">,</span><span class="mi">12</span><span class="o">/</span><span class="mi">04</span><span class="o">/</span><span class="mi">2011</span><span class="p">,</span><span class="n">pied</span>
<span class="n">NomParent3</span><span class="p">,</span><span class="n">PrenomParent3</span><span class="p">,</span><span class="n">NomEnfant3</span><span class="p">,</span><span class="n">PrenomEnfant3</span><span class="p">,</span><span class="mi">12</span><span class="o">/</span><span class="mi">04</span><span class="o">/</span><span class="mi">2011</span><span class="p">,</span><span class="n">vélo</span>
<span class="n">NomParent4</span><span class="p">,</span><span class="n">PrenomParent4</span><span class="p">,</span><span class="n">NomEnfant4</span><span class="p">,</span><span class="s2">&quot;Prenom, Enfant4&quot;</span><span class="p">,</span><span class="mi">12</span><span class="o">/</span><span class="mi">04</span><span class="o">/</span><span class="mi">2011</span><span class="p">,</span><span class="n">car</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting data.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NomParent</th>
      <th>PrenomParent</th>
      <th>NomEnfant</th>
      <th>PrenomEnfant</th>
      <th>DateNaissance</th>
      <th>Moyen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NomParent1</td>
      <td>PrenomParent1</td>
      <td>NomEnfant1</td>
      <td>PrenomEnfant1</td>
      <td>12/06/2010</td>
      <td>pied</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NomParent2</td>
      <td>PrenomParent2</td>
      <td>NomEnfant2</td>
      <td>PrenomEnfant2</td>
      <td>12/04/2011</td>
      <td>pied</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NomParent3</td>
      <td>PrenomParent3</td>
      <td>NomEnfant3</td>
      <td>PrenomEnfant3</td>
      <td>12/04/2011</td>
      <td>vélo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NomParent4</td>
      <td>PrenomParent4</td>
      <td>NomEnfant4</td>
      <td>Prenom, Enfant4</td>
      <td>12/04/2011</td>
      <td>car</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PDFGenerator" class="doc_header"><code>class</code> <code>PDFGenerator</code><a href="https://github.com/dataforgoodfr/covid_certificate_generator/tree/master/covid_certificate_generator/pdf_generator.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PDFGenerator</code>(<strong><code>config_file</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">school</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;school_name&#39;</span><span class="p">:</span><span class="s1">&#39;Ecole Jean Jaurès&#39;</span><span class="p">,</span>
    <span class="s1">&#39;school_adress&#39;</span><span class="p">:</span><span class="s1">&#39;rue Jean Jaurès, 42 000 Libreville&#39;</span><span class="p">,</span>
    <span class="s1">&#39;city&#39;</span><span class="p">:</span><span class="s1">&#39;Libreville&#39;</span>
<span class="p">}</span>
<span class="n">students_filename</span> <span class="o">=</span> <span class="s1">&#39;data.csv&#39;</span>
<span class="n">school_sign_filename</span> <span class="o">=</span> <span class="s1">&#39;cachet.jpg&#39;</span>

<span class="c1">#decoded = base64.b64decode(students_file)</span>
<span class="c1">#students_file = io.BytesIO(decoded)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">students_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">students_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">school_sign_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">school_sign_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">school_pdf</span> <span class="o">=</span> <span class="n">PDFGenerator</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">school_pdf</span><span class="o">.</span><span class="n">get_pdf_from_BytesIO</span><span class="p">(</span><span class="n">students_filename</span><span class="p">,</span> <span class="n">students_data</span><span class="p">,</span> <span class="n">school_sign_filename</span><span class="p">,</span> <span class="n">school_sign_data</span><span class="p">,</span> <span class="n">school</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="c1"># with open(&quot;pdf-bytesio.pdf&quot;, &quot;wb&quot;) as f:</span>
<span class="c1">#     f.write(res.encode())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Starting get_pdf_from_BytesIO...
Execution time for 4 pages: 0.03 second(s).
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/tmp/u7jtalxj.pdf
CPU times: user 16.6 ms, sys: 16.7 ms, total: 33.3 ms
Wall time: 31.9 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">students_file</span> <span class="o">=</span> <span class="s1">&#39;data.csv&#39;</span>
<span class="n">school_sign</span> <span class="o">=</span> <span class="s1">&#39;cachet.jpg&#39;</span>
<span class="n">school_pdf</span> <span class="o">=</span> <span class="n">PDFGenerator</span><span class="p">()</span>
<span class="n">school_pdf</span><span class="o">.</span><span class="n">get_pdf_from_file</span><span class="p">(</span><span class="n">students_file</span><span class="p">,</span> <span class="n">school_sign</span><span class="p">,</span> <span class="n">school</span><span class="p">,</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Execution time for 4 pages: 0.01 second(s).
Execution time for 4 pages: 0.01 second(s).
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 12.2 ms, sys: 378 µs, total: 12.6 ms
Wall time: 11.5 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From <a href="https://readxl.tidyverse.org/reference/excel_format.html">https://readxl.tidyverse.org/reference/excel_format.html</a></p>
<p>File signatures (in hexadecimal) for xlsx vs xls:</p>
<ul>
<li>xlsx: First 4 bytes are 50 4B 03 04</li>
<li>xls: First 8 bytes are D0 CF 11 E0 A1 B1 1A E1</li>
<li>CSV : b'\xef\xbb\xbfNo'</li>
<li>XLS : b'\xd0\xcf\x11\xe0\xa1'</li>
<li>XLSX : b'PK\x03\x04\x14'</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">students_file</span> <span class="o">=</span> <span class="s1">&#39;./assets/Fichier des élèves.csv&#39;</span>
<span class="n">school_pdf</span> <span class="o">=</span> <span class="n">PDFGenerator</span><span class="p">()</span>
<span class="n">school_pdf</span><span class="o">.</span><span class="n">get_pdf_from_file</span><span class="p">(</span><span class="n">students_file</span><span class="p">,</span> <span class="n">school_sign</span><span class="p">,</span> <span class="n">school</span><span class="p">,</span><span class="s1">&#39;test-csv.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Execution time for 343 pages: 0.119 second(s).
Execution time for 343 pages: 0.119 second(s).
Execution time for 343 pages: 0.119 second(s).
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 122 ms, sys: 622 µs, total: 122 ms
Wall time: 121 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">students_file</span> <span class="o">=</span> <span class="s1">&#39;./assets/Fichier des élèves.xls&#39;</span>
<span class="n">school_pdf</span> <span class="o">=</span> <span class="n">PDFGenerator</span><span class="p">()</span>
<span class="n">school_pdf</span><span class="o">.</span><span class="n">get_pdf_from_file</span><span class="p">(</span><span class="n">students_file</span><span class="p">,</span> <span class="n">school_sign</span><span class="p">,</span> <span class="n">school</span><span class="p">,</span><span class="s1">&#39;test-xls.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Execution time for 343 pages: 0.124 second(s).
Execution time for 343 pages: 0.124 second(s).
Execution time for 343 pages: 0.124 second(s).
Execution time for 343 pages: 0.124 second(s).
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 122 ms, sys: 6.66 ms, total: 129 ms
Wall time: 127 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">students_file</span> <span class="o">=</span> <span class="s1">&#39;./assets/Fichier des élèves.xlsx&#39;</span>
<span class="n">school_pdf</span> <span class="o">=</span> <span class="n">PDFGenerator</span><span class="p">()</span>
<span class="n">school_pdf</span><span class="o">.</span><span class="n">get_pdf_from_file</span><span class="p">(</span><span class="n">students_file</span><span class="p">,</span> <span class="n">school_sign</span><span class="p">,</span> <span class="n">school</span><span class="p">,</span><span class="s1">&#39;test-xlsx.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Starting get_pdf_from_file for Ecole Jean Jaurès
Execution time for 343 pages: 0.153 second(s).
Execution time for 343 pages: 0.153 second(s).
Execution time for 343 pages: 0.153 second(s).
Execution time for 343 pages: 0.153 second(s).
Execution time for 343 pages: 0.153 second(s).
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 159 ms, sys: 0 ns, total: 159 ms
Wall time: 158 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

